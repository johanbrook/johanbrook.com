<!DOCTYPE html>
<html lang="en-gb" class=" writingscustomizing-the-wordpress-admin-bar"><head itemtype="http://schema.org/Blog" itemscope="">
    <title>Customizing the Wordpress Admin Bar / Johan</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="preconnect" href="https://gc.zgo.at">
    <link rel="preconnect" href="https://johanbrook.goatcounter.com">

    <meta name="generator" content="Lume">

    
    <meta name="description" content="I'm a thirty-something designer and developer based in Sweden. I work with the best people in a company called Lookback, where I help interfaces come to life. I'm coding &amp; designering and I like working with product, user experience, interface design, and other things too.">
    
    
    <meta name="keywords" content="3.1,Add menu,Admin Bar,Customize,Functions.php,Hook,Menu,Wordpress">
    
    <meta name="author" content="Johan Brook">

    <!-- Styles-->
    <link rel="stylesheet" href="/johan.css">

    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" title="Johan Brook: Posts feed (Atom)" href="/writings.xml">
    <link rel="alternate" type="application/atom+xml" title="Johan Brook: Micro feed (Atom)" href="/micro.xml">
    <link rel="alternate" type="application/feed+json" title="Johan Brook: Micro feed (JSON)" href="/micro.json">
    <link rel="alternate" type="application/atom+xml" title="Johan Brook: Book feed (Atom)" href="/reading.xml">

    <link rel="shortcut icon" href="/favicon.png" type="image/png">
    <link rel="canonical" itemprop="url" href="https://johan.im/writings/customizing-the-wordpress-admin-bar/">
    <link rel="author" href="https://johan.im">
    <link rel="me" href="https://hachyderm.io/@brookie">

    <meta property="og:title" content="Customizing the Wordpress Admin Bar">
    <meta property="og:url" content="https://johan.im/writings/customizing-the-wordpress-admin-bar/">
    <meta property="og:site_name" itemprop="name" content="Johan Brook">
    
    <meta property="og:locale" content="en_GB">
    
    <meta property="og:description" content="I'm a thirty-something designer and developer based in Sweden. I work with the best people in a company called Lookback, where I help interfaces come to life. I'm coding &amp; designering and I like working with product, user experience, interface design, and other things too.">
    

    

    
	<meta property="og:type" content="article">
    <meta property="article:tag" content="3.1,Add menu,Admin Bar,Customize,Functions.php,Hook,Menu,Wordpress">
    <meta property="article:published_time" content="2011-03-03T01:00:00+01:00">
   	
  </head>

  <body>
  	  <a href="#main" class="visually-hidden skip-link">Skip to content</a>

	  <div class="Content">

		

<nav role="navigation" class="MobileNav">
    <p class="mb0">
        <a aria-label="Home" class="MobileNav__Home plain" href="/">Johan</a> <span class="faint">/</span> <a href="/writings" class="muted">Writings</a>
    </p>
    <div class="relative">
        <details>
            <summary>Menu</summary>
            <ul role="list" class="NavList">
              		<li>
             			<a href="/micro/">Micro</a>
              		</li>
              		<li>
             			<a href="/now/">Now</a>
              		</li>
              		<li>
             			<a href="/about/">About</a>
              		</li>
              		<li>
             			<a href="/reading/">Reading</a>
              		</li>
              		<li>
             			<a href="/feeds/">Feeds</a>
              		</li>
              		<li aria-current="page">
             			<a href="/writings/">Writings</a>
              		</li>
                <li>
         			<a href="/all">All pages</a>
          		</li>
            </ul>
        </details>
    </div>
</nav>


		<div id="main">
			<main role="main">
  <article class="Post" role="article" itemscope="" itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 itemprop="name" class="title">Customizing the Wordpress Admin Bar</h1>

      <p class="mb0 fw5">
          <time class="text-color-contrast" datetime="2011-03-03T01:00:00+01:00" title="Thursday, 3 March 2011 at 01:00:00 Central European Time" itemprop="datePublished" pubdate="">
            March 3, 2011
          </time>
          
          
      </p>

      <p class="f5 mb4 font-sans muted">
          About 3 min reading time
      </p>
    </header>

    <div class="prose" itemprop="articleBody">
      
      <p><strong>Wordpress 3.1 brought us</strong> a lot of things; an admin bar amongst others. That one’s been present
on hosted Wordpress.com blogs for quite some time, and available as a plugin as well. At first I
deactivated the bar at once, but later I realized it’s pretty handy to have around. I usually make
my own admin menus for quick access to stats, new posts and more, but the official admin bar is more
versatile (I’m using the Wordpress function <code>current_user_can("manage_options")</code> in an if-statement
to show the admin menu only to me).
<img src="http://213.185.255.138/core/wp-content/uploads/2011/03/Johan-Brook-adminbar-588x166.png" alt="" title="Johan-Brook-adminbar">
Anyway, how about customizing the admin bar? You know: add stuff, style stuff. Plugins and themes
may add their own menus to the bar, as with the Wordpress.com Stats plugin I’m using, for instance.
A small graph is shown in the bar if you’ve got the plugin installed, with a link to the admin stats
page. Neat — as you see on the screenshot above it also shows the shortlink to the current
page/post. The rendering of the bar itself builds upon a simple API you can hook into, but I haven’t
found any documentation in the Wordpress Codex yet though, so I’m gonna show some simple examples
from what I’ve picked up from the Wordpress core. First we need a hook. The Wordpress developers
advise us to use <code>admin_bar_menu</code>&nbsp;. Right on. Add this to <code>functions.php</code>&nbsp;:</p>
<p>add_action(“admin_bar_menu”, “customize_menu”);</p>
<p>function customize_menu(){
global $wp_admin_bar;</p>
<p>// Do stuff
}</p>
<p>The <code>customize_menu()</code> is a handler which will do stuff with the admin bar. We also need to define
the global <code>$wp_admin_bar</code> variable in order to call the API functions.</p>
<h2>The API</h2>
<p>The WP_Admin_Bar class includes the great <code>add_menu()</code> function which we use to add menus:</p>
<p>$wp_admin_bar-&gt;add_menu($args);</p>
<p>// Defaults:
$args = array(
“id” =&gt; false,
“title” =&gt; false,
“href” =&gt; false,
“parent” =&gt; false,
“meta” =&gt; false
);</p>
<p><code>id</code> (String) The id of your menu. Make sure it’s unique — this will identify your menu, and also be
used in the menu item’s <code>id</code> attribute in the HTML code like this:
<code>&lt;li id="wp-admin-bar-{$id}"&gt; ... &lt;/li&gt;</code> <code>title</code> (String) The title of your menu. Will be shown on
the front-end. <code>href</code> (String) The URL the menu post links to. <code>parent</code> (String) The id of the
parent menu, if you’d want that. <code>meta</code> (Array) Some handy extra stuff: “html”, “class”, “onclick”,
“title” and “target”. Ex: <code>"meta" =&gt; array("onclick" =&gt; 'alert("Hi there");')</code>&nbsp;. Note: the value of
“html” will be added directly after your menu item in the bar. So with these guys you could
construct something like this:</p>
<p>$wp_admin_bar-&gt;add_menu(array(
“id” =&gt; “mymenu”,
“title” =&gt; “A custom menu”,
“href” =&gt; “http://google.com”,
“meta” =&gt; array(“target” =&gt; “blank”)
));</p>
<p>… which will produce this:
<img src="http://213.185.255.138/core/wp-content/uploads/2011/03/JohanBrook-CustomMenu.png" alt="" title="JohanBrook-CustomMenu">
Neat. Now you have a custom, top-level menu item. What if you’d like to link to pages in the
Wordpress admin from your menu? Check out the <code>admin_url()</code> function. Use it to link directly to any
page in wp-admin, like this: <code>admin_url("nav-menus.php")</code>&nbsp;. Incredibly good for plugin authors.</p>
<h2>Dropdown menus</h2>
<p>A menu item is cool and all, but it would be awesome to add more items and group them, like in a
dropdown menu. We’ll go ahead and to that with the <code>parent</code> key in the argument array. Add this
below the previous code:</p>
<p>$wp_admin_bar-&gt;add_menu(array(
“id” =&gt; “my-child-menu”,
“title” =&gt; “Child”,
“parent” =&gt; “mymenu”
));</p>
<p>It behaves just like any other menu, but you’ll have to specify the <code>parent</code> key to the top-level
menu’s id. The children are automatically attached to the parent menu and shown on hover, as
expected:
<img src="http://213.185.255.138/core/wp-content/uploads/2011/03/JohanBrook-ChildMenu.png" alt="" title="JohanBrook-ChildMenu"></p>
<h2>External data</h2>
<p>So now it’s completely up to your needs. Just use functions and variables as usual as you du in
<code>functions.php</code>&nbsp;. For instance, just declare the global <code>$post</code> variable beside <code>$wp_admin_bar</code> and
you’ll have access to the current post’s data:</p>
<p>add_action(“admin_bar_menu”, “customize_menu”);</p>
<p>function customize_menu(){
global $wp_admin_bar, $post;</p>
<p>$children = get_children(array(“post_parent” =&gt; $post-&gt;ID));</p>
<p>$wp_admin_bar-&gt;add_menu(array(
“id” =&gt; “mymenu”,
“title” =&gt; “Post: ”&nbsp;. $post-&gt;post_title,
“href” =&gt; “http://google.com”,
“meta” =&gt; array(“target” =&gt; ‘blank’)
));</p>
<p>if($children){
foreach($children as $c){
$wp_admin_bar-&gt;add_menu(array(
“parent” =&gt; “mymenu”,
“title” =&gt; $c-&gt;post_title,
“href” =&gt; get_permalink($c-&gt;ID)
));
}
}</p>
<p>}</p>
<p>Simple enough: <em>get access to <code>$post</code> =&gt; Find eventual child pages =&gt; loop through and add to parent
item.</em>
<img src="http://213.185.255.138/core/wp-content/uploads/2011/03/JohanBrook-ChildPosts.png" alt="" title="JohanBrook-ChildPosts"></p>
<h2>Source</h2>
<p>You’ll find relevant source code in the files <code>wp-includes/class-wp-admin-bar.php</code> and
<code>wp-includes/admin-bar.php</code>&nbsp;. Funny: I just realized I had switched to Chrome for the last two
screenshots. You’ll just have to put up with that.</p>

    </div>
  </article>
</main>

		</div>

   		<nav role="navigation" class="MainNav">
	<div class="sticky">
		<h1 class="f4 font-sans">
			<a href="/" aria-label="Home">
				<span>Johan</span><span aria-hidden="true" class="BackLink ml2">←</span>
			</a>
		</h1>

		<ul role="list" class="NavList">
          		<li>
         			<a href="/micro/">Micro</a>
          		</li>
          		<li>
         			<a href="/now/">Now</a>
          		</li>
          		<li>
         			<a href="/about/">About</a>
          		</li>
          		<li>
         			<a href="/reading/">Reading</a>
          		</li>
          		<li>
         			<a href="/feeds/">Feeds</a>
          		</li>
          		<li aria-current="page">
         			<a href="/writings/">Writings</a>
          		</li>
            <li>
     			<a href="/all">All pages</a>
      		</li>
        </ul>
	</div>
</nav>

	  </div>

      <script>
  // Only load on production environment.
  if (window.location.host !== new URL('https://johan.im').host) {
    window.goatcounter = {no_onload: true};
  }

  // Skip own views
  if (window.location.hash === '#skipgc')
    localStorage.setItem('skipgc', 't');
  if (localStorage.getItem('skipgc') === 't')
    window.goatcounter = {no_onload: true};
</script>
<script data-goatcounter="https://johanbrook.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script>

  


</body></html>