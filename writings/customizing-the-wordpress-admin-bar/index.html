<!DOCTYPE html>
<html lang="en" class=" writingscustomizing-the-wordpress-admin-bar"><head itemtype="http://schema.org/Blog" itemscope="">
    <title>customizing the wordpress admin bar – johan brook</title>

    <meta charset="utf-8">

    
    <meta name="description" content="I'm a twenty-something designer and developer based in Sweden. I work with the best people in a company called Lookback, where I help interfaces come to life. I'm coding &amp; designering and I like working with product, user experience, interface design, and other things too.">
    
    
    <meta name="keywords" content="3.1,Add menu,Admin Bar,Customize,Functions.php,Hook,Menu,Wordpress">
    
    <meta name="author" content="Johan Brook">

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Styles-->
    <link rel="stylesheet" href="/johan.css">

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="Posts feed" href="/feed.xml">
    <link rel="alternate" type="application/rss+xml" title="Mind feed" href="/mind.xml">

    <link rel="shortcut icon" href="/favicon.png" type="image/png">
    <link rel="canonical" itemprop="url" href="https://johan.im/writings/customizing-the-wordpress-admin-bar/">
    <link rel="author" href="https://johan.im">

    <meta property="og:title" content="Customizing the Wordpress Admin Bar">
    <meta property="og:url" content="https://johan.im/writings/customizing-the-wordpress-admin-bar/">
    <meta property="og:site_name" itemprop="name" content="Johan Brook">
    <meta property="og:type" content="blog">
    <meta property="og:image" content="https://johan.im/assets/images/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="1200">
    

    
    <meta property="article:tag" content="3.1,Add menu,Admin Bar,Customize,Functions.php,Hook,Menu,Wordpress">
    <meta property="article:published_time" content="2011-03-03T00:00:00Z">
    
  </head>

  <body>

    <div class="Content">
      
        <nav role="navigation" class="SideNav">
  <div class="SideNav__inner">
    <h1 class="f3 no-rhythm">
      <a href="/">Johan Brook</a>
    </h1>

    <div>
      <label class="SideNav__toggle btn" for="mobile-nav-trigger">
        Menu
      </label>
    </div>
  </div>

  <input type="checkbox" id="mobile-nav-trigger">

  <ul>
      <li>
        <a href="/writings/">Writings</a>
      </li>
      <li>
        <a href="/now/">Now</a>
      </li>
      <li>
        <a href="/mind/">On my mind</a>
      </li>
      <li>
        <a href="/reading/">Reading</a>
      </li>
      <li>
        <a href="/about/">About me</a>
      </li>
      <li>
        <a href="/contact/">Contact</a>
      </li>
  </ul>
</nav>

      

      <main role="main">
  <article class="Post" role="article" itemscope="" itemtype="http://schema.org/BlogPosting">
    <header> 
      <h1 itemprop="name" class="title">Customizing the Wordpress Admin Bar</h1>

      <p class="mb0 fw5 mt3">
          <time datetime="2011-03-03T00:00:00Z" itemprop="datePublished" pubdate="">March 3rd, 2011</time>
          
      </p>

      <p class="muted mb4">
          About 3 min reading time
      </p>
    </header>

    <div class="prose measure" itemprop="articleBody">
      
      <p><strong>Wordpress 3.1 brought us</strong> a lot of things; an admin bar amongst others. That one's been present on hosted Wordpress.com blogs for quite some time, and available as a plugin as well. At first I deactivated the bar at once, but later I realized it's pretty handy to have around. I usually make my own admin menus for quick access to stats, new posts and more, but the official admin bar is more versatile (I'm using the Wordpress function <code>current_user_can("manage_options")</code> in an if-statement to show the admin menu only to me). <img src="http://213.185.255.138/core/wp-content/uploads/2011/03/Johan-Brook-adminbar-588x166.png" alt="" title="Johan-Brook-adminbar"> Anyway, how about customizing the admin bar? You know: add stuff, style stuff. Plugins and themes may add their own menus to the bar, as with the Wordpress.com Stats plugin I'm using, for instance. A small graph is shown in the bar if you've got the plugin installed, with a link to the admin stats page. Neat – as you see on the screenshot above it also shows the shortlink to the current page/post. The rendering of the bar itself builds upon a simple API you can hook into, but I haven't found any documentation in the Wordpress Codex yet though, so I'm gonna show some simple examples from what I've picked up from the Wordpress core. First we need a hook. The Wordpress developers advise us to use <code>admin_bar_menu</code> . Right on. Add this to <code>functions.php</code> :</p>
<pre><code>add_action("admin_bar_menu", "customize_menu");

function customize_menu(){
    global $wp_admin_bar;

    // Do stuff
}
</code></pre>
<p>The <code>customize_menu()</code> is a handler which will do stuff with the admin bar. We also need to define the global <code>$wp_admin_bar</code> variable in order to call the API functions.</p>
<h2>The API</h2>
<p>The WP_Admin_Bar class includes the great <code>add_menu()</code> function which we use to add menus:</p>
<pre><code>$wp_admin_bar-&gt;add_menu($args);

// Defaults:
$args = array(
   "id" =&gt; false,
   "title" =&gt; false,
   "href" =&gt; false,
   "parent" =&gt; false,
   "meta" =&gt; false
);
</code></pre>
<p><code>id</code> (String) The id of your menu. Make sure it's unique – this will identify your menu, and also be used in the menu item's <code>id</code> attribute in the HTML code like this: <code>&lt;li id="wp-admin-bar-{$id}"&gt; ... &lt;/li&gt;</code> <code>title</code> (String) The title of your menu. Will be shown on the front-end. <code>href</code> (String) The URL the menu post links to. <code>parent</code> (String) The id of the parent menu, if you'd want that. <code>meta</code> (Array) Some handy extra stuff: "html", "class", "onclick", "title" and "target". Ex: <code>"meta" =&gt; array("onclick" =&gt; 'alert("Hi there");')</code> . Note: the value of "html" will be added directly after your menu item in the bar. So with these guys you could construct something like this:</p>
<pre><code>$wp_admin_bar-&gt;add_menu(array(
   "id" =&gt; "mymenu",
   "title" =&gt; "A custom menu",
   "href" =&gt; "http://google.com",
   "meta" =&gt; array("target" =&gt; "blank")
));
</code></pre>
<p>... which will produce this: <img src="http://213.185.255.138/core/wp-content/uploads/2011/03/JohanBrook-CustomMenu.png" alt="" title="JohanBrook-CustomMenu"> Neat. Now you have a custom, top-level menu item. What if you'd like to link to pages in the Wordpress admin from your menu? Check out the <code>admin_url()</code> function. Use it to link directly to any page in wp-admin, like this: <code>admin_url("nav-menus.php")</code> . Incredibly good for plugin authors.</p>
<h2>Dropdown menus</h2>
<p>A menu item is cool and all, but it would be awesome to add more items and group them, like in a dropdown menu. We'll go ahead and to that with the <code>parent</code> key in the argument array. Add this below the previous code:</p>
<pre><code>$wp_admin_bar-&gt;add_menu(array(
	"id" =&gt; "my-child-menu",
	"title" =&gt; "Child",
	"parent" =&gt; "mymenu"
));
</code></pre>
<p>It behaves just like any other menu, but you'll have to specify the <code>parent</code> key to the top-level menu's id. The children are automatically attached to the parent menu and shown on hover, as expected: <img src="http://213.185.255.138/core/wp-content/uploads/2011/03/JohanBrook-ChildMenu.png" alt="" title="JohanBrook-ChildMenu"></p>
<h2>External data</h2>
<p>So now it's completely up to your needs. Just use functions and variables as usual as you du in <code>functions.php</code> . For instance, just declare the global <code>$post</code> variable beside <code>$wp_admin_bar</code> and you'll have access to the current post's data:</p>
<pre><code>add_action("admin_bar_menu", "customize_menu");

function customize_menu(){
	global $wp_admin_bar, $post;

	$children = get_children(array("post_parent" =&gt; $post-&gt;ID));

	$wp_admin_bar-&gt;add_menu(array(
		"id" =&gt; "mymenu",
		"title" =&gt; "Post: " . $post-&gt;post_title,
		"href" =&gt; "http://google.com",
		"meta" =&gt; array("target" =&gt; 'blank')
	));

	if($children){
		foreach($children as $c){
			$wp_admin_bar-&gt;add_menu(array(
				"parent" =&gt; "mymenu",
				"title" =&gt; $c-&gt;post_title,
				"href" =&gt; get_permalink($c-&gt;ID)
			));
		}
	}

}
</code></pre>
<p>Simple enough: <em>get access to <code>$post</code> =&gt; Find eventual child pages =&gt; loop through and add to parent item.</em> <img src="http://213.185.255.138/core/wp-content/uploads/2011/03/JohanBrook-ChildPosts.png" alt="" title="JohanBrook-ChildPosts"></p>
<h2>Source</h2>
<p>You'll find relevant source code in the files <code>wp-includes/class-wp-admin-bar.php</code> and <code>wp-includes/admin-bar.php</code> . Funny: I just realized I had switched to Chrome for the last two screenshots. You'll just have to put up with that.</p>

    </div>

    <footer>
      
        <p class="f5 comp-grey mt5">
          <b class="mr1">Keywords</b> <span class="Post-Keyword">3.1</span><span class="Post-Keyword">Add menu</span><span class="Post-Keyword">Admin Bar</span><span class="Post-Keyword">Customize</span><span class="Post-Keyword">Functions.php</span><span class="Post-Keyword">Hook</span><span class="Post-Keyword">Menu</span><span class="Post-Keyword">Wordpress</span>
        </p>
      

      <p class="mt3">
        <a href="/writings" class="btn">&lt;- More writings</a>
      </p>
    </footer>
  </article>
</main>

    </div>

    <footer role="contentinfo">
  <nav>
    <ul class="flex gap justify-center f6 list-reset mb2">
        <li><a href="/">Home</a></li>
        <li><a href="/feed.xml" title="Atom">Post feed</a></li>
        <li><a href="/mind.xml" title="Atom">Mind feed</a></li>
        <li><a href="/credits">Credits</a></li>
        <li><a href="/changelog">Changelog</a></li>
        <li><a href="/api.json">api.json</a></li>
    </ul>
  </nav>

  <p class="muted f6 tc mb0">
    Using <a class="font-mono" href="https://github.com/johanbrook/johanbrook.com/commit/f0c0f4a9700831b0e88f609b2f03b08b32d83c8f">f0c0f4a</a> — built at <time>2022-01-31T08:42:34.209Z</time>
  </p>
</footer>


    <script>
  // Only load on production environment.
  if (window.location.host !== new URL('https://johan.im').host) {
    window.goatcounter = {no_onload: true};
  }

  // Skip own views
  if (window.location.hash === '#skipgc')
    localStorage.setItem('skipgc', 't');
  if (localStorage.getItem('skipgc') === 't')
    window.goatcounter = {no_onload: true};
</script>
<script data-goatcounter="https://johanbrook.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script>

  


</body></html>